<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juego - Rompecabezas Accesible</title>
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>


    <!-- Selecci√≥n de Categor√≠a -->
    <section id="category-selection" class="category-section">
        <header class="category-header">
            <h1>Rompecabezas Inclusivo</h1>
            <p>Selecciona una categor√≠a para comenzar:</p>
        </header>

        <div class="category-grid" role="group" aria-label="Selecci√≥n de categor√≠a">
            <div class="category-card" tabindex="0" role="button" onclick="selectCategory('animales')"
                onkeydown="if(event.key==='Enter' || event.key===' '){event.preventDefault(); selectCategory('animales');}"
                aria-label="Categor√≠a Animales: Le√≥n majestuoso">
                <div class="category-image"
                    style="background-image: url('https://images.unsplash.com/photo-1546182990-dffeafbe841d?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80');">
                </div>
                <h2>ü¶Å Animales</h2>
                <p>Le√≥n majestuoso</p>
            </div>

            <div class="category-card" tabindex="0" role="button" onclick="selectCategory('paisajes')"
                onkeydown="if(event.key==='Enter' || event.key===' '){event.preventDefault(); selectCategory('paisajes');}"
                aria-label="Categor√≠a Paisajes: Monta√±as nevadas">
                <div class="category-image"
                    style="background-image: url('https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80');">
                </div>
                <h2>üèîÔ∏è Paisajes</h2>
                <p>Monta√±as nevadas</p>
            </div>

            <div class="category-card" tabindex="0" role="button" onclick="selectCategory('comida')"
                onkeydown="if(event.key==='Enter' || event.key===' '){event.preventDefault(); selectCategory('comida');}"
                aria-label="Categor√≠a Comida: Frutas frescas">
                <div class="category-image"
                    style="background-image: url('https://images.unsplash.com/photo-1619566636858-adf3ef46400b?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80');">
                </div>
                <h2>üçì Comida</h2>
                <p>Frutas frescas</p>
            </div>

            <div class="category-card" tabindex="0" role="button" onclick="selectCategory('arte')"
                onkeydown="if(event.key==='Enter' || event.key===' '){event.preventDefault(); selectCategory('arte');}"
                aria-label="Categor√≠a Arte: Arte abstracto colorido">
                <div class="category-image"
                    style="background-image: url('https://images.unsplash.com/photo-1541961017774-22349e4a1262?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80');">
                </div>
                <h2>üé® Arte</h2>
                <p>Arte abstracto colorido</p>
            </div>
        </div>

        <div style="margin-top: 30px;">
            <a href="index.html" style="text-decoration: none;">
                <button>üè† Volver al Inicio</button>
            </a>
        </div>
    </section>

    <!-- Secci√≥n del Juego -->
    <div id="game-section" style="display: none;">
        <header>
            <h1>Rompecabezas Inclusivo</h1>
            <div class="instructions">
                <p><strong>Objetivo:</strong> Reorganiza la imagen.</p>
                <p><strong>C√≥mo jugar (Accesible):</strong>
                    1. Haz clic (o pulsa Enter) en una pieza para seleccionarla.<br>
                    2. Haz clic en otra pieza para intercambiarlas de lugar.<br>
                    3. Navega entre piezas con <strong>Tab</strong>, <strong>W/A/S/D</strong> o las <strong>flechas del
                        teclado</strong>.<br>
                    No es necesario arrastrar.
                </p>
            </div>
        </header>

        <nav class="controls" aria-label="Controles del juego">
            <button onclick="startGame()">Reiniciar Juego</button>

            <!-- Selector de Dificultad (Separado de Accesibilidad) -->
            <div class="difficulty-control">
                <select id="grid-size" onchange="changeGridSize(this.value)" aria-label="Seleccionar dificultad">
                    <option value="3" selected>Dificultad: F√°cil (3x3)</option>
                    <option value="4">Dificultad: Media (4x4)</option>
                    <option value="5">Dificultad: Dif√≠cil (5x5)</option>
                </select>
            </div>

            <div class="accessibility-menu-container">
                <button id="acc-menu-btn" aria-haspopup="true" aria-expanded="false" onclick="toggleMenu()">
                    Accesibilidad ‚ôø
                </button>
                <div id="acc-menu-panel" class="accessibility-panel hidden" role="menu" aria-labelledby="acc-menu-btn">

                    <div class="menu-item">
                        <label for="contrast-toggle">Alto Contraste</label>
                        <button id="contrast-toggle" onclick="toggleContrast()"
                            aria-pressed="false">Desactivado</button>
                    </div>

                    <div class="menu-item">
                        <label for="color-blindness-select">Daltonismo</label>
                        <select id="color-blindness-select" onchange="changeColorBlindnessMode(this.value)">
                            <option value="normal">Normal</option>
                            <option value="protanopia">Protanop√≠a (Rojo)</option>
                            <option value="deuteranopia">Deuteranop√≠a (Verde)</option>
                            <option value="tritanopia">Tritanop√≠a (Azul)</option>
                            <option value="achromatopsia">Acromatopsia (Grises)</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Filtros SVG para Daltonismo (Ocultos) -->
            <svg style="display: none">
                <defs>
                    <filter id="protanopia">
                        <feColorMatrix type="matrix" values="0.567, 0.433, 0, 0, 0
                                     0.558, 0.442, 0, 0, 0
                                     0, 0.242, 0.758, 0, 0
                                     0, 0, 0, 1, 0" />
                    </filter>
                    <filter id="deuteranopia">
                        <feColorMatrix type="matrix" values="0.625, 0.375, 0, 0, 0
                                     0.7, 0.3, 0, 0, 0
                                     0, 0.3, 0.7, 0, 0
                                     0, 0, 0, 1, 0" />
                    </filter>
                    <filter id="tritanopia">
                        <feColorMatrix type="matrix" values="0.95, 0.05, 0, 0, 0
                                     0, 0.433, 0.567, 0, 0
                                     0, 0.475, 0.525, 0, 0
                                     0, 0, 0, 1, 0" />
                    </filter>
                    <filter id="achromatopsia">
                        <feColorMatrix type="matrix" values="0.299, 0.587, 0.114, 0, 0
                                     0.299, 0.587, 0.114, 0, 0
                                     0.299, 0.587, 0.114, 0, 0
                                     0, 0, 0, 1, 0" />
                    </filter>
                </defs>
            </svg>

            <button onclick="showCategorySelection()">Cambiar Categor√≠a</button>

            <a href="index.html" style="text-decoration: none;">
                <button>Volver al Inicio</button>
            </a>
        </nav>

        <!-- Regi√≥n ARIA Live para anunciar cambios a lectores de pantalla -->
        <div id="announcer" class="sr-only" aria-live="polite" style="position:absolute; left:-9999px;"></div>

        <div class="status-bar">
            <span id="timer-display">Tiempo: 00:00</span>
            <span id="moves-display">Movimientos: 0</span>
        </div>

        <!-- Tablero del juego -->
        <main class="game-board" id="board" role="grid" aria-label="Tablero de rompecabezas de 3 por 3">
            <!-- Las piezas se generar√°n aqu√≠ con JS -->
        </main>

        <div id="win-message" role="alert">
            <h2>¬°Felicidades!</h2>
            <p>Has completado el rompecabezas.</p>
        </div>
    </div>


    <script src="js/game.js"></script>
</body>

</html>